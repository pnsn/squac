
<div id="column">
  <div id="title">
    <h2>Notification Settings</h2>
    <a mat-button [routerLink]="[ '/monitors' ]">View Monitors</a>
  </div>
  <div class="header-info">
    <h3>Contacts</h3>
    <button
      mat-button
      color="primary"
      (click)="addContact()" > <mat-icon>add</mat-icon>Add Contact</button>
  </div>

  <p class="help-text" *ngIf="availableContacts.length === 0">Add contacts in order to set up notifications.</p>

  <form [formGroup]="contactsForm">
    <div formArrayName="contacts">

      <div *ngFor="let contact of contacts.controls; let i=index">
    
        <div [formGroupName]="i" class="contact"> 
          <mat-form-field>
            <mat-label for="name">Name</mat-label>
            <input matInput formControlName="name" type="text">
          </mat-form-field>
          <mat-form-field>
            <mat-label for="email">Email</mat-label>
            <input matInput formControlName="email" type="email">
          </mat-form-field>
          <mat-form-field>
            <mat-label for="sms">SMS</mat-label>
            <input matInput formControlName="sms" type="tel">
          </mat-form-field>
          <div class="button-container">
            <button mat-icon-button color="accent" (click)="saveContact(i)"><mat-icon>save</mat-icon></button>
            <button mat-icon-button color="warn" (click)="removeContact(i)"><mat-icon>delete</mat-icon></button>
          </div>

        </div>
    
      </div>
    </div>
  </form>

  <div class="header-info">
    <h3>Notifications</h3>
    <button
      mat-button
      (click)="addNotification()" 
      color="primary"
      > <mat-icon>add</mat-icon>Add Notification</button>
  </div>
  <p class="help-text" *ngIf="availableContacts.length === 0">Add contacts in order to set up notifications.</p>
  <p class="help-text">
    Select a level, a contact, and a type of notification to receive alerts.
  </p>

  <form [formGroup]="notificationsForm">
    <div formArrayName="notifications">

      
      <div *ngFor="let notification of notifications.controls; let i=index">
    
        <div [formGroupName]="i" class="notification"> 
          <mat-form-field>
            <mat-label for="level">Level</mat-label>
            <mat-select formControlName="level" name="level">
              <mat-option *ngFor="let l of [1, 2, 3]" [value]="l"> {{l}} </mat-option>
            </mat-select>
          </mat-form-field>
          
          <mat-form-field>
            <mat-label for="contact">Contact</mat-label>
            <mat-select formControlName="contact" name="contact">
              <mat-option *ngFor="let contact of availableContacts" [value]="contact"> {{contact.name}} </mat-option>
            </mat-select>
          </mat-form-field>
          
          <mat-radio-group aria-label="Select an type" formControlName="type">
            <mat-radio-button value="email" default>Email</mat-radio-button>
            <mat-radio-button value="sms">SMS</mat-radio-button>
          </mat-radio-group>
          <div class="button-container">
            <button  mat-icon-button color="accent" (click)="saveNotification(i)"><mat-icon>save</mat-icon></button>
            <button  mat-icon-button color="warn" (click)="removeNotification(i)"><mat-icon>delete</mat-icon></button>
          </div>
        </div>
    
      </div>
    </div>
  </form>


</div>